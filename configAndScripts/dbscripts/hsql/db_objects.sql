/* *******************************************************************************************
						GestPymeSOC - DataBase Schemas and Objects Script
+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
Prefijo MAT_, para tablas maestras que apliquen para cualquier aplicacion ademas de GestPymeSOC,
Prefijo GPT_, para tablas del modelo propio de GestPymeSOC
------------------------------------------------------------------------------------------------
Usar el prefijo ID_, concatenado con el sufijo de la tabla, para columnas de tipo Clave primaria numerica
Ejemplo: Tabla MAT_PAISES, tiene el sufijo "PAISES" por tanto la columna de clave primaria se llama ID_PAIS
------------------------------------------------------------------------------------------------
Para columnas que representen codigos estandar establecidos por entidades gubernamentales o como codificacion
propia definida internamente, se usa el prefijo COD_
******************************************************************************************** */
CREATE CACHED TABLE MAT_PAISES(
	ID_PAIS INTEGER GENERATED BY DEFAULT AS IDENTITY(START WITH 1) NOT NULL PRIMARY KEY,
	NOM_PAIS VARCHAR(128) NOT NULL,
	COD_DANE VARCHAR() NOT NULL,
	CONSTRAINT PAISES_COD_DANE_UK UNIQUE (COD_DANE)
);

CREATE CACHED TABLE MAT_DEPARTAMENTOS(
	ID_DEPARTAMENTO INTEGER GENERATED BY DEFAULT AS IDENTITY(START WITH 1) NOT NULL PRIMARY KEY,
	COD_DEPARTAMENTO VARCHAR(3) NOT NULL,
	NOMBRE VARCHAR(128) NOT NULL,
	ID_PAIS INTEGER NOT NULL,
	CONSTRAINT DEPART_COD_UK UNIQUE (COD_DEPARTAMENTO)
);

CREATE CACHED TABLE MAT_CIUDADES(
	ID_CIUDAD INTEGER GENERATED BY DEFAULT AS IDENTITY(START WITH 1) NOT NULL PRIMARY KEY,
	COD_CIUDAD VARCHAR(4) NOT NULL,
	NOMBRE VARCHAR(128) NOT NULL,
	ID_DEPARTAMENTO INTEGER NOT NULL,
	CONSTRAINT CIUD_COD_UK UNIQUE (COD_CIUDAD)
);

CREATE CACHED TABLE MAT_DIRECCIONES(
	ID_DIRECCION INTEGER GENERATED BY DEFAULT AS IDENTITY(START WITH 1) NOT NULL PRIMARY KEY,
	COD_TIPO_VIA_PPAL VARCHAR(15),
	NUMERO_VIA_PPAL VARCHAR(3),
	LETRAS_VIA_PPAL VARCHAR(3),
	BIS VARCHAR(3),
	NUMERO_BIS VARCHAR(3),
	LETRAS_BIS VARCHAR(3),
	CUADRANTE_VIA_PPAL VARCHAR(10),
	COD_COMPLEM_VIA_PPAL VARCHAR(15),
	DETAL_COMPLEM_VIA_PPAL VARCHAR(40),
	NUMERO_VIA_SECUND VARCHAR(3),
	LETRAS_VIA_SECUND VARCHAR(3),
	NUMERO_VIA_COMPLEM VARCHAR(3),
	CUADRANTE_VIA_COMPLEM VARCHAR(10),
	COD_COMPLEM_VIA_COMPLEM VARCHAR(15),
	DETAL_COMPLEM_VIA_COMPLEM VARCHAR(40)
);

CREATE CACHED TABLE MAT_GRUPOS_EMPRESARIALES(
	ID_GRUPO_EMPRESARIAL INTEGER GENERATED BY DEFAULT AS IDENTITY(START WITH 1) NOT NULL PRIMARY KEY,
	RAZON_SOCIAL VARCHAR(128) NOT NULL,
	IDENTICACION_TRIBUTARIA VARCHAR(10) NOT NULL,
	DIGITO_VERIFICACION VARCHAR(1) NOT NULL,
	ID_CIUDAD INTEGER NOT NULL,
	NUM_PBX VARCHAR(15),
	NUM_TELEFONO1 VARCHAR(15),
	NUM_TELEFONO2 VARCHAR(15),
	ID_DIRECCION INTEGER,
	CONSTRAINT GRUP_EMPRE_NIT_UK UNIQUE (IDENTICACION_TRIBUTARIA),
	CONSTRAINT GRUP_EMPRE_CIUD_FK FOREIGN KEY (ID_CIUDAD) REFERENCES MAT_CIUDADES (ID_CIUDAD) ON UPDATE NO ACTION ON DELETE NO ACTION,
	CONSTRAINT GRUP_EMPRE_DIRECC_FK FOREIGN KEY (ID_DIRECCION) REFERENCES MAT_DIRECCIONES (ID_DIRECCION) ON UPDATE NO ACTION ON DELETE NO ACTION
);

CREATE CACHED TABLE MAT_EMPRESAS(
	ID_EMPRESA INTEGER GENERATED BY DEFAULT AS IDENTITY(START WITH 1) NOT NULL PRIMARY KEY,
	RAZON_SOCIAL VARCHAR(128) NOT NULL,
	IDENTICACION_TRIBUTARIA VARCHAR(10),
	DIGITO_VERIFICACION INTEGER(1),
	ID_GRUPO_EMPRESARIAL INTEGER NOT NULL,
	ID_CIUDAD INTEGER NOT NULL,
	NUM_PBX VARCHAR(15),
	NUM_TELEFONO1 VARCHAR(15),
	NUM_TELEFONO2 VARCHAR(15),
	ID_DIRECCION INTEGER,
	COD_TIPO_PERSONA VARCHAR(64) NOT NULL,
	ID_TIPO_CONTRIBUYENTE INTEGER NOT NULL,
	CONSTRAINT EMPRE_NIT_UK UNIQUE (IDENTICACION_TRIBUTARIA),
	CONSTRAINT EMPRE_ID_GRUPO_FK FOREIGN KEY (ID_GRUPO_EMPRESARIAL) REFERENCES GPT_GRUPO_EMPRESARIAL (ID_GRUPO_EMPRESARIAL) ON UPDATE NO ACTION ON DELETE NO ACTION,
	CONSTRAINT EMPRE_CIUD_FK FOREIGN KEY (ID_CIUDAD) REFERENCES MAT_CIUDADES (ID_CIUDAD) ON UPDATE NO ACTION ON DELETE NO ACTION,
	CONSTRAINT EMPRE_DIRECC_FK FOREIGN KEY (ID_DIRECCION) REFERENCES MAT_DIRECCIONES (ID_DIRECCION) ON UPDATE NO ACTION ON DELETE NO ACTION
);

CREATE CACHED TABLE MAT_TIPOS_CONTRIBUYENTE(
	ID_TIPO_CONTRIBUYENTE INTEGER GENERATED BY DEFAULT AS IDENTITY(START WITH 1) NOT NULL PRIMARY KEY,
	COD_TIPO_CONTRIBUYENTE VARCHAR(15),
	NOMBRE VARCHAR(128),
	DESCRIPCION VARCHAR(128),
	RETEFUENTE_RENTA_APLICABLE VARCHAR(1),
	RETEFUENTE_IVA_APLICABLE VARCHAR(1),
	RETEFUENTE_ICA_APLICABLE VARCHAR(1),
	DECLARA_IVA VARCHAR(1),
	DECLARA_RENTA VARCHAR(1),
	CONSTRAINT TIPO_CONTRIB_COD_UK UNIQUE (COD_TIPO_CONTRIBUYENTE),
	CONSTRAINT TIPO_CONTRIB_RRENTA_APLIC_CK CHECK (COD_TIPO_CONTRIBUYENTE IN('N','S'))
);

/* *****************************************************
	Grupos Tarifarios que definen las tarifas para las actividades economicas
****************************************************** */
CREATE CACHED TABLE MAT_GRUPOS_TARIFA_ACTI_ECONOM(
	ID_GRUPO_TARIFARIO INTEGER GENERATED BY DEFAULT AS IDENTITY(START WITH 1) NOT NULL PRIMARY KEY,
	COD_GRUPO_TARIFARIO VARCHAR(15),
	NOMBRE VARCHAR(128),
	TARIFA_X_MIL_VIGENTE NUMERIC(8,2)
);

CREATE CACHED TABLE MAT_ACTIVIDADES_ECONOMICAS(
	ID_ACTIVIDAD_ECONOMICA INTEGER GENERATED BY DEFAULT AS IDENTITY(START WITH 1) NOT NULL PRIMARY KEY,
	COD_ACTIVIDAD_CIIU,
	GRUPO_TARIFARIO,
);

CREATE CACHED TABLE MAT_TERCEROS(
	ID_TERCERO INTEGER GENERATED BY DEFAULT AS IDENTITY(START WITH 1) NOT NULL PRIMARY KEY,
	ID_PAIS INTEGER NOT NULL,
	ID_DEPARTAMENTO INTEGER NOT NULL,
	ID_CIUDAD INTEGER NOT NULL,
	ID_DIRECCION INTEGER,
	NUM_TELEFONO1 VARCHAR(15),
	NUM_TELEFONO2 VARCHAR(15),
	COD_TIPO_PERSONA VARCHAR(64),
	ID_TIPO_CONTRIBUYENTE INTEGER NOT NULL,
	http://www.gerencie.com/grandes-contribuyentes.html
	http://es.slideshare.net/AldairFernandezCueto/empresa-clasificacion-de-las-empresas-contabilidad-objetivos-de-la-contabilidadtipos-de-contabildad
);

CREATE CACHED TABLE MAT_USUARIOS(
	
);


CREATE CACHED TABLE GPT_TABLA_DE_GESTPYMESOC(
	
);

/*
	TIPOS ENUMERADOS
	TIPOS_PERSONA(PERSONA NATURAL PERSONA JURIDICA)
	CONCEPTOS_RETENCION_IVA(COMPRAS, SERVICIOS)
	CONCEPTOS_RETENCION_RENTA(COMPRAS, SERVICIOS, ARRENDAMIENTOS)
*/